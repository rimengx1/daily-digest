name: Daily Deploy

on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Generate Daily Digest
        run: |
          mkdir -p daily-digest/content
          DIGEST_FILE="daily-digest/content/digest-$(date +%Y%m%d).md"
          TODAY="$(date +%Y-%m-%d)"

          cat > "$DIGEST_FILE" <<EOF
          # Daily Digest - $TODAY

          Auto-generated by GitHub Actions.

          - Generated at: $(date -u '+%Y-%m-%d %H:%M:%S UTC')
          - Note: This workflow now uses only basic shell commands.
          EOF

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./daily-digest
